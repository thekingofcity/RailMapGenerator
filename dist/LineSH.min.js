(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{25:function(t,e,s){"use strict";s.r(e);var n=s(5),r=s(6),i=s(2);class a extends r.a{constructor(t,e){super(t,e),this.stnNum=e.num}get _nameShift(){return!1}get _tickRotation(){return this.y>0?180:0}get _dxdy(){var t=this.name[1].split("\\").length;let e;return e=this._nameShift?0===this._tickRotation?-9:16+12*(t-1)*Math.cos(-45):0===this._tickRotation?(24+12*(t-1))*Math.cos(-45):-6,[e,0===this._tickRotation?-25.921875-12*(t-1)*Math.cos(-45):17.5]}get iconHTML(){var[t,e]=-1==this.state?["stn_sh_pass","Pass"]:["stn_sh","Future"];return $("<g>",{transform:`translate(${this.x},${this.y})`}).append($("<use>",{"xlink:href":"#"+t,class:"rmg-stn"}))}get nameHTML(){let[t,e]=this._dxdy;return $("<g>",{transform:`translate(${this.x-t},${this.y+e})rotate(-50)`,"text-anchor":0===this._tickRotation?"start":"end",class:"Name Future"}).append($("<text>").addClass("rmg-name__zh rmg-name__shmetro--station").text(this.name[0])).append($("<text>",{dy:15,class:"rmg-name__en rmg-name__shmetro--station"}).text(this.name[1].split("\\")[0]).append($("<tspan>",{x:0,dy:12}).text(this.name[1].split("\\")[1])))}}class o extends a{constructor(t,e){super(t,e),this._intInfos=e.transfer.info[0]}get html(){return $("<g>",{id:this.id}).append(...this.ungrpHTML)}get ungrpHTML(){return[this.iconHTML,this.nameHTML]}get ungrpIconHTML(){return[...this.intTickHTML]}get iconHTML(){var[t,e]=-1==this.state?["int2_sh_pass","Pass"]:["int2_sh","Future"];return $("<g>",{transform:`translate(${this.x},${this.y})`}).append($("<use>",{"xlink:href":"#"+t,class:"rmg-stn",stroke:this._intInfos[i.b.colour]}))}get nameHTML(){let[t,e]=this._dxdy;return $("<g>",{transform:`translate(${this.x-t},${this.y+e})`}).append($("<g>",{id:`rmg-name__shmetro--${this.id}`,"text-anchor":0===this._tickRotation?"start":"end",class:"Name Future"}).append($("<text>").addClass("rmg-name__zh rmg-name__shmetro--station").text(this.name[0])).append($("<text>",{dy:15,class:"rmg-name__en rmg-name__shmetro--station"}).text(this.name[1].split("\\")[0]).append($("<tspan>",{x:0,dy:12}).text(this.name[1].split("\\")[1]))))}get intTickHTML(){let t=[],e=$(`#rmg-name__shmetro--${this.id}`),s=e.get(0).getBoundingClientRect(),n=s.right-s.left+5;this._intInfos.map((e,s)=>{let r=e[i.b.colour],a=$("<use>",{fill:r,class:"rmg-line__shmetro rmg-line__change"});-1==this.state&&a.addClass("rmg-line__pass");let o=$("<text>",{class:"rmg-name__zh rmg-name__shmetro--line_name","text-anchor":"middle",fill:e[i.b.fg]}),l=String(e[i.b.nameZH]).match(/(\d*)\w+/);if(l){var h=l[0];a.attr({"xlink:href":"#int_sh_number",transform:`translate(${n+25*s},-12)`}),o.attr({transform:`translate(${n+10+25*s},8)`}).text(h)}else{h=String(e[i.b.nameZH]);a.attr({"xlink:href":"#int_sh_letter",transform:`translate(${n+70*s},-12)`}),o.attr({transform:`translate(${n+30+70*s},8)`}).text(h)}t.push(a,o)});let r=e.parent();return r.attr("transform",`${r.attr("transform")}rotate(-50)`),t}get _nameClass(){return-1==this.state?"Pass":"Future"}}s.d(e,"RMGLineSH",(function(){return l}));class l extends n.a{constructor(t){super(t)}_initStnInstance(t,e){switch(e.change_type){case"int2":case"int3_l":case"int3_r":return new o(t,e);case"osi11_ul":case"osi11_pl":case"osi11_ur":case"osi11_pr":case"osi12_ul":case"osi12_pl":case"osi12_ur":case"osi12_pr":case"osi21_ul":case"osi21_pl":case"osi21_ur":case"osi21_pr":case"osi22_ul":case"osi22_pl":case"osi22_ur":case"osi22_pr":default:return new a(t,e)}}drawDestInfo(){$("#station_info_shmetro > #platform > text").text(this._platformNum);var t=310+$("#station_info_shmetro > #dest_text")[0].getBoundingClientRect().width+45+50;let e=this._svgHeight-300;var s="l"==this._direction?1:-1,n=(this._svgDestWidth-s*t)/20;n="l"==this._direction?n:this._svgDestWidth-20;var r=90*(1-s);$("#station_info_shmetro > #arrow_left_use").attr("transform",`translate(${n},${135+e})rotate(${r})`);var i=n+285*s;if($("#station_info_shmetro > #platform").attr("transform",`translate(${i},${130+e})`),"r"===this._direction)var a="end",o=.8*this._svgDestWidth;else a="start",o=.2*this._svgDestWidth;$("#station_info_shmetro > #dest_text").attr({transform:`translate(${o},${135+e})`,"text-anchor":a});var[l,h]=[[],[]];this[`${this._direction}ValidDests`].forEach(t=>{l.push(this.stations[t].name[0]),h.push(this.stations[t].name[1])}),$("#station_info_shmetro > #dest_text > text:first-child").text(`往${l.join("，")}`),$("#station_info_shmetro > #dest_text > text:last-child").text(`To ${h.join(", ")}`);let _="l"===this._direction?this._svgDestWidth:360;var[m,u]=this._lineNames,d=m.match(/(\d*)\w+/);d?(_-=180,m="号线",$("#station_info_shmetro > #line_number > rect").attr({fill:this._themeColour,transform:`translate(${_-150},${70+e})`}),$("#station_info_shmetro > #line_number > text").show().text(d[0]).attr({transform:`translate(${_-95},${170+e})`,style:"letter-spacing:-10px","text-anchor":"middle"}),$("#station_info_shmetro > #line_name_text text").attr("fill","black")):(_-=280,$("#station_info_shmetro > #line_number > rect").attr({fill:this._themeColour,transform:`translate(${_-10},${60+e})`,width:260,height:150}),$("#station_info_shmetro > #line_number > text").hide(),$("#station_info_shmetro > #line_name_text text").removeAttr("fill"),$("#station_info_shmetro > #line_name_text > text:last-child").attr("dx",10)),$("#station_info_shmetro > #line_name_text > text:first-child").text(m),$("#station_info_shmetro > #line_name_text > text:last-child").text(u),$("#station_info_shmetro > #line_name_text").attr({transform:`translate(${_},${135+e})`,"text-anchor":"start"});let c="";c="l"==this._direction?`M38,10 H ${this._svgDestWidth-20} V 24 H 24 Z`:`M24,10 H ${this._svgDestWidth-30} l 12,12 H 24 Z`,$("#line_shmetro_use").attr({transform:`translate(0,${220+e})`,d:c})}drawStns(){for(let[t,e]of Object.entries(this.stations))["linestart","lineend"].includes(t)||$("#stn_icons").append(e.html);$("#stn_icons").html($("#stn_icons").html());for(let[t,e]of Object.entries(this.stations).filter(t=>t[1]instanceof o))$(`#rmg-name__shmetro--${t}`).parent().append(e.ungrpIconHTML);$("#stn_icons").html($("#stn_icons").html())}_stnYShare(t){return this.branches[0].includes(t)?0:3}_linePath(t,e){var[s,n,r]=[],i={};const a=30;if(t.forEach(t=>{var[e,a]=["_stnRealX","_stnRealY"].map(e=>this[e](t));if(!n&&0!==n)return[s,r,n]=[t,e,a],void(i.start=[e,a]);0===a?a!=n&&(i.bifurcate=[r,n]):a!=n&&(i.bifurcate=[e,a]),i.end=[e,a],[s,r,n]=[t,e,a]}),i.hasOwnProperty("start")){if(i.hasOwnProperty("end")){if(i.hasOwnProperty("bifurcate")){let[t,s]=i.start,[n,r]=(i.end[0],i.bifurcate),[o,l]=i.end;return"main"===e?"l"===this._direction?l>s?`M ${t-a},${s-6} H ${n+a} L ${o},${l-6} l 0,12 L ${n+a},${r+6} L ${t-a-12},${s+6} Z`:`M ${o},${l-6} H ${n-a} L ${t},${s-6} l 0,12 L ${n-a},${r+6} L ${o},${l+6} Z`:l>s?`M ${t},${s-6} H ${n+a} L ${o},${l-6} l 0,12 L ${n+a},${r+6} L ${t},${s+6} Z`:`M ${o+a},${l-6} H ${n-a} L ${t},${s-6} l 0,12 L ${n-a},${r+6} L ${o+a+12},${l+6} Z`:(this._direction,l>s?`M ${t-a},${s-6} H ${n+a} L ${o},${l-6} l 0,12 L ${n+a},${r+6} L ${t-a},${s+6} Z`:`M ${t},${s-6} L ${n-a},${r-6} H ${o+a} l 0,12 L ${n-a},${r+6} L ${t},${s+6} Z`)}{let[t,s]=i.start,n=i.end[0];return"main"===e?"l"===this._direction?`M ${t-a},${s-6} H ${n} l 0,12 L ${t-42},${s+6} Z`:`M ${t},${s-6} H ${n+a} l 12,12 L ${t},${s+6} Z`:(this._direction,`M ${t-a},${s-6} H ${n+a} l 0,12 L ${t-a},${s+6} Z`)}}{let[t,s]=i.start;return"main"===e?"l"===this._direction?`M ${t},${s-6} L ${t-a},${s-6} l -12,12 L ${t},${s+6} Z`:`M ${t},${s-6} L ${t+a},${s-6} l 12,12 L ${t},${s+6} Z`:"l"===this._direction?`M ${t},${s-6} L ${t+a},${s-6} l 0,12 L ${t-a},${s+6} Z`:`M ${t-a},${s-6} L ${t},${s-6} l 0,12 L ${t-a},${s+6} Z`}}return""}drawLine(){$(".rmg-line").removeClass("rmg-line__mtr").addClass("rmg-line__shmetro"),this.branches.map(t=>{var e=t.filter(t=>this.stations[t].state>=0),s=t.filter(t=>this.stations[t].state<=0);1===e.length&&(s=t),0==e.filter(t=>-1!==s.indexOf(t)).length&&e.length&&(s[0]===t[0]?s.push(e[0]):e[0]===t[0]&&e[e.length-1]===t[t.length-1]&&s.length?(s=t,e=[]):s.unshift(e[e.length-1])),$("#line_main").append($("<path>",{d:this._linePath(e,"main")})),$("#line_pass").append($("<path>",{d:this._linePath(s,"pass")}))}),$("#line_main").html($("#line_main").html()),$("#line_pass").html($("#line_pass").html()),$("#railmap > #main").attr("transform",`translate(0,${this._svgHeight-63})`)}fillThemeColour(){super.fillThemeColour(),$("circle#stn_sh").attr("stroke",this._themeColour),$("path#int2_sh").attr("stroke",this._themeColour),$("#line_main").children().attr("fill",this._themeColour),$("#line_pass").children().attr("fill","#aaa"),$("#line_shmetro_use").attr("fill",this._themeColour),$("#station_info_shmetro > #line_name_text").attr("fill",this._fgColour),$("#station_info_shmetro > #line_number > rect").attr("fill",this._themeColour),$("#station_info_shmetro > #line_number > text").attr("fill",this._fgColour)}updateStnNameBg(){$("#current_bg").hide()}static initSVG(t){t.drawSVGFrame(),t.showFrameOuter(),t.drawStns(),t.drawLine(),t.fillThemeColour(),t.drawStrip(),t.drawDestInfo(),t.updateStnNameBg()}set direction(t){super.direction=t,this.fillThemeColour()}set currentStnId(t){super.currentStnId=t,this.fillThemeColour()}set lineNames(t){super.lineNames=t,this.drawDestInfo()}updateStnTransfer(t,e,s=null){super.updateStnTransfer(t,e,s),this.fillThemeColour(),$("#stn_icons").empty(),this.drawStns()}addStn(t,e,s,n){let[r,i]=super.addStn(t,e,s,n);return this.fillThemeColour(),[r,i]}set svgHeight(t){super.svgHeight=t,this.drawLine()}set padding(t){super.padding=t,this.fillThemeColour()}set branchSpacing(t){super.branchSpacing=t,this.fillThemeColour()}removeStn(t){return!!super.removeStn(t)&&(this.fillThemeColour(),!0)}updateBranchType(t,e,s){return!!super.updateBranchType(t,e,s)&&(this.fillThemeColour(),!0)}updateBranchFirst(t,e,s){return!!super.updateBranchFirst(t,e,s)&&(this.fillThemeColour(),!0)}updateBranchPos(t,e,s){return!!super.updateBranchPos(t,e,s)&&(this.fillThemeColour(),!0)}}}}]);